<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="calculator.css">
    <title>Calculadora Backbone</title>
</head>

<body>

    <div class="container-calculadora">
        <h1>Calculadora Backbone</h1>
        <div class="output">
            <input type="text" id="operacion" placeholder="0">
        </div>
        <div class="numeros">
            <button class="numero">1</button>
            <button class="numero">2</button>
            <button class="numero">3</button>
            <button class="numero operador">+</button>
            <button class="numero">4</button>
            <button class="numero">5</button>
            <button class="numero">6</button>
            <button class="numero operador">-</button>
            <button class="numero">7</button>
            <button class="numero">8</button>
            <button class="numero">9</button>
            <button class="numero operador">*</button>
            <button class="numero" id="borrar">C</button>
            <button class="numero">0</button>
            <button class="numero operador">/</button>
            <input type="submit" id="calcular" value="=">
        </div>
    </div>

    
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.0/backbone.localStorage-min.js" type="text/javascript"></script>

    <script type="text/javascript">
    let app = {};

app.Calculadora = Backbone.Model.extend({
    defaults: {
        operacion: ''
    },
    calcularResultado: function () {
        const operacion = this.get('operacion');
        let resultado;

        try {
            resultado = eval(operacion);
        } catch (error) {
            resultado = NaN;
        }

        if (isNaN(resultado)) {
            resultado = 'Error en la operaci√≥n';
        }

        return resultado;
    }
});

app.CalculadoraView = Backbone.View.extend({
    el: '.container-calculadora',
    initialize: function () {
        this.inputOperacion = this.$('#operacion');
        this.numeros = this.$('.numeros');

    },
     events: {
        'click .numero': 'agregarNumero',
        'click #calcular': 'mostrarResultado',
        'click #borrar': 'borrarOperacion'
    },
    agregarNumero: function (event) {
        const numero = $(event.target).text();
        const operacion = this.inputOperacion.val();
        this.inputOperacion.val(operacion + numero);
    },
    mostrarResultado: function () {
        const operacion = this.inputOperacion.val();
        const calculadora = new app.Calculadora({ operacion: operacion });
        const resultado = calculadora.calcularResultado();

        this.inputOperacion.val(resultado);
    },
    borrarOperacion: function () {
        this.inputOperacion.val('');
    }
});

let calculadoraView = new app.CalculadoraView();

    </script>

</body>

<!-- se comento otra forma de hacer la calculadora -->

<!-- <body class="container-calculadora">
    <h1>Calculadora Backbone</h1>
    <input type="text" id="operador1" placeholder="Operador 1">
    <input type="text" id="operacion" placeholder="+, -, *, /">
    <input type="text" id="operador2" placeholder="Operador 2">
    <input type="submit" id="calcular">
    <p id="resultado"></p>

</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"
    type="text/javascript"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.0/backbone.localStorage-min.js"
    type="text/javascript"></script>

<script type="text/javascript">

    let app = {};


    app.Calculadora = Backbone.Model.extend({
        defaults: {
            operador1: 0,
            operacion: '+',
            operador2: 0
        }
    });

    app.Calculadoras = Backbone.Collection.extend({
        model: app.Calculadora
    });

    app.calculadoras = new app.Calculadoras();

    app.CalculadoraView = Backbone.View.extend({
        el: $('.container-calculadora'), //le digo cual va a ser el contenedor, el es palabra reservada
        initialize: function () {
            this.input1 = this.$('#operador1');
            this.input2 = this.$('#operador2');
            this.input3 = this.$('#operacion');
            this.input4 = this.$('#calcular');
            this.resultado = this.$('#resultado');
 
        },
        events: { 
            'keyup #operador1': 'calculaNum',
            'keyup #operador2': 'calculaNum',
            'keyup #operacion': 'calculaNum',
            'click #calcular': 'calcularResultado'
            
        },
            
        calculaNum: function (event) {
            // this.calcularResultado()
        },

        calcularResultado: function () { 

        const num1 = this.input1.val()
        const operacion = this.input3.val()
        const num2 = this.input2.val()

        let results = eval(`${num1} ${operacion} ${num2}`);

        this.resultado.html(results)
        console.log(this.resultado.val());

        }

    })

    app.calculadorasView = new app.CalculadoraView();

    // colecciones y vistas siempre hay que instanciarlas

</script> -->

</html>
